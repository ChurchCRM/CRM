box: php

build:
  steps:
    - install-packages:
        checkpoint: pkgs  
        packages: git npm node zip unzip

    - npm-install
    
    - grunt:
        tasks: curl-dir
    
    - script:
        name: setup composer
        code: |
          curl -sS https://getcomposer.org/installer | php
          sudo mv composer.phar /usr/local/bin/composer
          echo "composer version $(composer --version) running"
          
    - script:
        name: Composer installs
        code: |
          cd src
          composer update
          
    - script:
        name: propel setup
        code: |         
          cd src        
          vendor/bin/propel model:build --config-dir=propel
          composer dump-autoload
          
gen-changelog:
  steps:          
    - script:
      name: setup ruby gems information
      code: |
        sudo apt-get install -y ruby
        gem install multi_json github_changelog_generator          
